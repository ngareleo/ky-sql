#!/bin/bash

usage(){
    echo "Usage: $0 <build|run> examples <example_number>"
    echo "Examples:"
    echo "  $0 build examples 0   # Build example 0"
    echo "  $0 run examples 0     # Run example 0"
}

build_example() {
    EXAMPLE_NUM=$1
    BUILD_DIR="build"
    if [ ! -d "$BUILD_DIR" ]; then
        mkdir "$BUILD_DIR"
    fi
    cd "$BUILD_DIR" || exit 1
    if [ ! -f Makefile ]; then
        cmake ..
    fi
    cmake --build . --target run_example_0${EXAMPLE_NUM}_filemetadata
}

run_example() {
    EXAMPLE_NUM=$1
    BUILD_DIR="build"
    cd "$BUILD_DIR" || exit 1
    ./src/Examples/run_example_0${EXAMPLE_NUM}_filemetadata
}

if [ "$1" = "build" ] && [ "$2" = "examples" ] && [ -n "$3" ]; then
    build_example "$3"
elif [ "$1" = "run" ] && [ "$2" = "examples" ] && [ -n "$3" ]; then
    run_example "$3"
else
    usage
fi